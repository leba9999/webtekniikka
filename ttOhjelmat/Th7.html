<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <title>Th 7</title>
    <style>
    </style>
</head>
<body>
<h3>Javascript Tehtävä 7</h3>

<script>
    'use strict';
    // ehdokkaiden nimet
    let candidatesNames = ["Liam", "Olivia", "Noah", "Emma", "Oliver", "Ava", "William", "Sophia", "Elijah", "Isabella", "James", "Charlotte", "Benjamin", "Amelia", "Lucas", "Mia", "Mason", "Harper", "Ethan", "Evelyn", "UNKNOWN"];
    let candidateVotes = [];
    let amountOfcandidates = 0;
    let amountOfvoters = 0;
    // Kysellään ehdokaiden määrää
    do {
        amountOfcandidates = +prompt(`Kuinka monta ehdokasta: `);
    } while(amountOfcandidates <= 0)
    // Kysellään äänestäjien määrää
    do {
        amountOfvoters = +prompt(`Kuinka monta äänestäjää: `);
    }while (amountOfvoters <= 0)

    // annetaan ehdokkaiden äänien määrä taulukon alkioihin alkuarvoksi 0
    // äänien taulukon viimeisin alkio on varattu aina tyhjälle äänestäville siksi (<=)
    for (let i = 0; i <= amountOfcandidates; i++){
        candidateVotes[i] = 0;
    }
    // äänestäjät äänestävät omalla vuorollaan ehdokasta antamalla tämän ehdokkaan äänestys numeron
    // jos äänestys numeroksi annetaan 0 tai +prompt() antama NaN arvo äänestäjä äänestää silloin tyhjää
    // jos äänestäjä antaa liian suuren arvon kysytään uudelleen äänestäjältä while loopissa kelpaava arvo
    for (let i = 0; i < amountOfvoters; i++){
        let candidateNum = +prompt(`${i + 1}. äänestäjä syötä ehdokkaan numero (1-${amountOfcandidates}) tai 0 äänestääksesi tyhjää`);
        while (candidateNum > amountOfcandidates){
            candidateNum = +prompt(`${i + 1}. äänestäjä Syötit liian suuren luvun!!\nSyötä 1-${amountOfcandidates} tai 0 äänestääksesi tyhjää`);
        }
        if (candidateNum <= 0 || isNaN(candidateNum)){
            candidateVotes[candidateVotes.length - 1] += 1;
            continue;
        }
        candidateVotes[candidateNum - 1] += 1;
    }
    // jos liian moni äänestää tyhjää niin äänestys tulos on heikko
    if(amountOfvoters / 3 >= candidateVotes[candidateVotes.length - 1]) {
        // Voittaja ehdokkaan äänien määrä
        let winnerCandidateVotes = 0;
        // taulukkoon asetetaan kaikki mahdolliset voittajat (voittajien indeksi) koska tasapeli on mahdollista!
        let winners = [];
        // Tutkitaan mikä on suurin ääni saalis
        for (let i = 0; i < amountOfcandidates; i++) {
            if (candidateVotes[i] > winnerCandidateVotes) {
                winnerCandidateVotes = candidateVotes[i];
            }
        }
        // Etsitään ehdokkaiden äänistä suurimpien äänien määrä ja tallenetaan niiden ehdokkaiden
        // indeksi winners taulukkoon
        for (let i = 0; i <= amountOfcandidates; i++) {
            if (candidateVotes[i] == winnerCandidateVotes) {
                winners.push(i);
            }
        }
        // jos voittajia on 1 tai vähemmän ilmoitus on yksikkömuodossa
        // muuten monikossa
        if (winners.length <= 1) {
            document.write(`<br>Äänestyksen Voittaja:`);
        } else {
            document.write(`<br>Äänestyksen Voittajat:`);
        }
        // Ilmoitetaan kaikki mahdolliset voittajat
        for (let i = 0; i < winners.length; i++) {
            document.write(`<br>${winners[i] + 1}. ${candidatesNames[winners[i]]}`);
        }
        document.write(`<br>Äänillä: ${winnerCandidateVotes}`);
    }
    else {
        document.write(`<br>Liian moni äänesti tyhjää (äänestäjistä > 1/3): ${candidateVotes[candidateVotes.length - 1]}`);
    }
    // Kerrotaan muiden ääni saaliit
    document.write(`<br><br>Annetut äänet:`);
    for (let i = 0; i < candidateVotes.length-1; i++){
        // jos ehdokkaiden demo nimiä ei ole tarpeeksi käytetään aina ehdokas nimi taulukosta viimeisintä alkiota joka on UNKNOWN
        // jotta varmistetaan että saadaan varmasti haluttu tulostus
        // muuten tulostetaan ihan normaalisti ehdokkaan indeksi ja nimi.
        if (candidatesNames.length - 1 <= i){
            document.write(`<br>${i + 1}. ${candidatesNames[candidatesNames.length - 1]}: ${candidateVotes[i]}`);
        }
        else {
            document.write(`<br>${i + 1}. ${candidatesNames[i]}: ${candidateVotes[i]}`);
        }
    }
    // Tyhjää äänestävien ääni:
    document.write(`<br>Tyhjää: ${candidateVotes[candidateVotes.length-1]}`);

</script>

</body>
</html>